<div class="forgot-password-container">
    <div class="forgot-password-form">
      <!-- Step 1: Enter Email -->
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" *ngIf="!otpSent">
        <label for="email">Enter your email:</label>
        <input
          id="email"
          type="email"
          formControlName="email"
          placeholder="Enter your email"
        />
        <div *ngIf="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched" class="error">
          <small *ngIf="forgotPasswordForm.get('email')?.errors?.['required']">
            Email is required.
          </small>
          <small *ngIf="forgotPasswordForm.get('email')?.errors?.['email']">
            Please enter a valid email.
          </small>
        </div>
           <!-- New error message for email not found -->
      <div *ngIf="forgotPasswordForm.get('email')?.errors?.['notFound']" class="error">
        <small>Email not found in our records.</small>
      </div>
        <button type="submit" [disabled]="forgotPasswordForm.invalid">Send OTP</button>
      </form>
  
      <!-- Step 2: Enter OTP -->
      <form *ngIf="otpSent && !otpVerified" (ngSubmit)="verifyOtp()">
        <label for="otp">Enter OTP:</label>
        <input id="otp" type="text" [(ngModel)]="otp" name="otp" placeholder="Enter OTP" />
        <div *ngIf="otpError" class="error">
          <small>Invalid OTP. Please try again.</small>
        </div>
        <button type="submit">Verify OTP</button>
      </form>
  
      <!-- Step 3: Enter New Password -->
      <form *ngIf="otpVerified" [formGroup]="passwordForm" (ngSubmit)="resetPassword()">
        <label for="newPassword">New Password:</label>
        <div class="password-container">
          <input
            id="newPassword"
            [type]="newPasswordVisible ? 'text' : 'password'"
            formControlName="newPassword"
            placeholder="Enter new password"
          />
          <!-- Eye emoji for password visibility toggle -->
          <span
            class="toggle-icon"
            (click)="toggleNewPasswordVisibility()"
          >{{ newPasswordVisible ? 'ğŸ‘' : 'ğŸ™ˆ'  }}</span>
        </div>
        <div *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched" class="error">
          <small *ngIf="passwordForm.get('newPassword')?.errors?.['required']">
            New password is required.
          </small>
          <small *ngIf="passwordForm.get('newPassword')?.errors?.['minlength']">
            Password must be at least 8 characters long.
          </small>
          <small *ngIf="passwordForm.get('newPassword')?.errors?.['pattern']">
            Password must contain at least one uppercase letter, one lowercase letter, one digit, and one special character.
          </small>
        </div>
  
        <label for="confirmPassword">Confirm New Password:</label>
        <div class="password-container">
          <input
            id="confirmPassword"
            [type]="confirmPasswordVisible ? 'text' : 'password'"
            formControlName="confirmPassword"
            placeholder="Confirm new password"
          />
          <!-- Eye emoji for password visibility toggle -->
          <span
            class="toggle-icon"
            (click)="toggleConfirmPasswordVisibility()"
          >{{ confirmPasswordVisible ? 'ğŸ‘' : 'ğŸ™ˆ' }}</span>
        </div>
        <div *ngIf="passwordMismatch" class="error">
          <small>Passwords do not match.</small>
        </div>
        <button type="submit" [disabled]="passwordForm.invalid">Reset Password</button>
      </form>
    </div>
  </div>